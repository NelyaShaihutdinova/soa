global
    daemon
    maxconn 256

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms

frontend https_in
    bind *:8443 ssl crt /usr/local/etc/haproxy/certs/baeldung.pem
    use_backend second_payara_nodes if { path_beg /reports /shop /vehicles }
    default_backend app_nodes

backend app_nodes
    balance roundrobin
    server dictionary_first dictionary_first:8452 ssl verify none check

backend second_payara_nodes
    balance roundrobin
    http-request set-path /ejb_web%[path]
    server second_1 second_payara_1:8459 ssl verify none check
    server second_2 second_payara_2:8460 ssl verify none check
